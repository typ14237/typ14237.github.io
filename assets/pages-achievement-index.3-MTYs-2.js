import{p as a,r as e,N as l,y as s,o as t,z as n,f as o,b as u,u as i,w as r,F as c,h as m,a as d,e as f,d as g,t as _,c as p,g as v,m as y,G as b,S as k,E as x,n as h,i as j}from"./index-BssrTN_v.js";import{_ as D,u as C,r as w,a as L}from"./useRootFontSize.KxEFqd7D.js";import{u as S,_ as z}from"./useBack.Burpmcax.js";import{u as Y,g as F}from"./medal.BLDV1qJX.js";import{u as M,L as N}from"./loginDia.BGoWqxzD.js";import{u as B}from"./useDayjs.By1QBtKa.js";import"./uni-popup.9Wv9sbD9.js";const E=D({__name:"index",setup(D){const{pagination:E,tableData:G,getTableData:I,handleCurrentChange:J}=Y(F,{initParam:{my_self:!0}}),{needLogin:O}=x(),{back:P}=S(),{rootFontSize:R}=C(),{user:T,loginStatus:$}=a(M()),{format:q}=B(),A=e(!1),H=l([]),K=e(null);s(O,(a=>{a&&b((()=>{U()}))}),{immediate:!0}),s($,(async a=>{await Q()})),t((async()=>{await Q()}));const Q=async()=>{await I(),H.value=G.value||[],console.log("getMedalList",H.value,G.value)},U=()=>{K.value.openLogin()},V=async()=>{const a=E.value.page+1;a<=E.value.page_count?(await J(a),H.value.push(...G.value)):A.value=!0,console.log(E.value,H.value)},W=a=>q(a,"YYYY年MM月DD日");return(a,e)=>{const l=w(n("page-meta"),L),s=w(n("uni-nav-bar"),z),t=m,b=j,x=k;return d(),o(c,null,[u(l,{"root-font-size":i(R)},null,8,["root-font-size"]),u(t,{class:"achievement-box"},{default:r((()=>[u(t,{class:"header-box"},{default:r((()=>[u(s,{"left-icon":"left",color:"#333",backgroundColor:"transparent",fixed:!0,onClickLeft:i(P),border:!1,title:"成就勋章"},null,8,["onClickLeft"]),u(t,{class:"user-box"},{default:r((()=>[f("img",{src:"/static/img/user.png"}),u(t,{class:"user-name"},{default:r((()=>{var a;return[g(_((null==(a=i(T))?void 0:a.username)||"元宇宙er"),1)]})),_:1}),u(t,{class:"medal-num"},{default:r((()=>{var a;return[g("已获得成就勋章："+_((null==(a=H.value)?void 0:a.length)||0),1)]})),_:1})])),_:1}),u(t,{class:"medal-title"},{default:r((()=>[g("全部勋章")])),_:1})])),_:1}),H.value.length>0?(d(),p(x,{key:0,onScrolltolower:V,"scroll-y":!0},{default:r((()=>[u(t,{class:"medal-list"},{default:r((()=>[(d(!0),o(c,null,v(H.value,(a=>(d(),p(t,{class:"medal-item",key:a.id,onClick:e=>(a=>{const e={name:a.name,url:a.url,get_time:W(null==a?void 0:a.get_time)};h({url:`/pages/medalDetail/index?medal=${JSON.stringify(e)}`})})(a)},{default:r((()=>[u(t,{class:"medal-img"},{default:r((()=>[f("img",{src:a.url},null,8,["src"])])),_:2},1024),u(t,{class:"medal-info"},{default:r((()=>[u(t,{class:"medal-name"},{default:r((()=>[g(_(a.name),1)])),_:2},1024),u(t,{class:"medal-time"},{default:r((()=>[g(_(W(null==a?void 0:a.get_time)),1)])),_:2},1024)])),_:2},1024),u(t,{class:"medal-place"},{default:r((()=>[u(b,{class:"location"},{default:r((()=>[g(_(a.description),1)])),_:2},1024),f("img",{src:"/static/img/right-btn.png"})])),_:2},1024)])),_:2},1032,["onClick"])))),128)),A.value?(d(),p(t,{key:0,class:"not-more"},{default:r((()=>[g("暂无更多")])),_:1})):y("",!0)])),_:1})])),_:1})):(d(),p(t,{key:1,class:"null-medals-box"},{default:r((()=>[f("img",{src:"/static/img/null-medals.png",class:"notfount"}),u(t,{class:"notfount-text"},{default:r((()=>[g("未获得勋章")])),_:1}),u(t,{class:"notfount-desc"},{default:r((()=>[g("请完成挑战赢得勋章")])),_:1})])),_:1})),u(N,{ref_key:"loginDia",ref:K},null,512)])),_:1})],64)}}},[["__scopeId","data-v-eb24f089"]]);export{E as default};
