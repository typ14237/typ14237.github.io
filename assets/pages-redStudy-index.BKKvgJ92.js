import{p as a,r as s,y as e,o as t,z as l,f as i,b as c,u as o,w as d,F as n,h as u,a as r,e as f,d as _,g as p,t as m,G as g,I as k,s as b,n as h,i as y,j as x,c as w,q as D,m as v,E as j,C as S,A as T}from"./index-BssrTN_v.js";import{_ as C,u as L,r as M,a as A}from"./useRootFontSize.KxEFqd7D.js";import{_ as R}from"./uni-popup.9Wv9sbD9.js";import{u as $,_ as P,a as z,T as F,S as H,b as B}from"./shoppingDia.Bbpu9fNp.js";import{H as N,_ as q,O as I}from"./openBrowserDia.Cp3QwztI.js";import{_ as O}from"./logo.Bw7MxNqG.js";import{u as E,M as G,p as X,S as U,i as J,n as K}from"./shareDia.DOtd7zYj.js";import{u as Q,g as V}from"./task.QoYPsyFY.js";import{u as W,L as Y,R as Z}from"./loginDia.BGoWqxzD.js";import{S as aa,L as sa,w as ea}from"./locationDia.BOWJxkiq.js";import{u as ta}from"./medal.BLDV1qJX.js";import{u as la}from"./useDayjs.By1QBtKa.js";const ia=C({__name:"index",setup(C){const ia=Q(),{needLogin:ca}=j(),{loginStatus:oa}=a(W()),{goods:da}=$(),{medalImgs:na,medalPath:ua}=a(E()),{rootFontSize:ra}=L(),{format:fa}=la(),{tableData:_a,getTableData:pa}=ta(V,{initParam:{project:"study"},dataCallBack:a=>{let s=null==a?void 0:a.list;s&&s.length>0&&(s=s.forEach((a=>{"check_in"===a.task_type&&(a.disable=!1)})))}}),ma=s(null),ga=s(null),ka=s(null),ba=s(null),ha=s(null),ya=s(null),xa=s(null),wa=[{desc:"记录美好瞬间",src:"/static/img/red-study/feature1.png"},{desc:"成就上链储存",src:"/static/img/red-study/feature2.png"},{desc:"量化日常生活",src:"/static/img/red-study/feature3.png"}];e(ca,(a=>{a&&La()})),e((()=>ia.redFulfilNum),((a,s)=>{a===ia.redStudyTask.length&&0!==s&&g((()=>{Ma()}))})),e(oa,(async a=>{await Da()})),t((async()=>{}));const Da=async()=>{await pa();const a=o(_a)[0];ia.updateActivity(a),ia.updateTaskList("redStudyTask",null==a?void 0:a.children)},va=()=>{xa.value.openRule()},ja=()=>{ha.value.openLocation()},Sa=()=>{ba.value.openShopping()},Ta=()=>!!k()||(La(),!1),Ca=()=>{if(J()){const a=`${location.origin}/#/pages/download/index`;b({data:a,success:function(){ma.value.openBrowser()}})}else h({url:"/pages/download/index"})},La=()=>{ga.value.openLogin()},Ma=()=>{ka.value.openMedal(ia.activity.id)};return(a,s)=>{const e=M(l("page-meta"),A),t=u,g=y,k=x,b=M(l("uni-icons"),R);return r(),i(n,null,[c(e,{"root-font-size":o(ra)},null,8,["root-font-size"]),c(t,{class:"content-wrapper"},{default:d((()=>[c(N,{onLogin:Ta,onOpenRule:va}),c(t,{class:"content-header"},{default:d((()=>[f("img",{class:"header-top-border",src:P}),c(t,{class:"header-content"},{default:d((()=>[c(t,{class:"header-title"},{default:d((()=>[c(t,{class:"title-text1 text-pos1"},{default:d((()=>[_("我的")])),_:1}),c(t,{class:"title-text1 text-pos2"},{default:d((()=>[_("韶山行")])),_:1}),c(t,{class:"title-text2 text-pos3 no-rem-text-stroke-black"},{default:d((()=>[_(" 韶山 ")])),_:1}),c(t,{class:"title-text2 text-pos4"},{default:d((()=>[_("Going out")])),_:1}),c(t,{class:"title-text2 text-pos5"},{default:d((()=>[_("SHAOSHAN")])),_:1}),c(t,{class:"title-text2 text-pos6"},{default:d((()=>[_("打卡得勋章")])),_:1})])),_:1}),c(t,{class:"header-card"},{default:d((()=>[c(G,{class:"model",width:o(X)("200px"),height:o(X)("200px"),scaleFactor:3,isScale:!1,isRoll:!1,path:o(ua)},null,8,["width","height","path"]),c(t,{class:"activity-box"},{default:d((()=>[c(t,null,{default:d((()=>[(r(),i(n,null,p(3,(a=>f("img",{key:a,class:"avatar",src:`/static/img/avatar${a}.png`},null,8,["src"]))),64))])),_:1}),c(t,{class:"user"},{default:d((()=>[c(g,null,{default:d((()=>[_(m(`{ ${o(ia).userNum}名用户已参与 }`),1)])),_:1}),c(g,{class:"t-bg bg-light-brown t-bg-pos"})])),_:1}),c(t,{class:"activity-time"},{default:d((()=>[c(g,null,{default:d((()=>[_("本期活动时间：")])),_:1}),f("br"),c(g,{class:"t-18"},{default:d((()=>[_(m(`${o(fa)(o(ia).activity.create_at,"MM.DD")}-${o(fa)(o(ia).activity.end_time,"MM.DD")}`),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),c(t,{class:"header-footer"},{default:d((()=>[f("img",{class:"header-bottom-border",src:z}),c(t,{class:"header-footer-fill1"}),c(t,{class:"header-footer-fill2"})])),_:1})])),_:1}),c(t,{class:"main pad-16"},{default:d((()=>[c(t,{class:"task-box"},{default:d((()=>[c(t,{class:"task-box1"},{default:d((()=>[c(t,{class:"task-num"},{default:d((()=>[c(g,{class:"f-white no-rem-text-stroke-black"},{default:d((()=>[_(" 当前任务需要完成 ")])),_:1}),c(g,{class:"f-light-brown no-rem-text-stroke-black"},{default:d((()=>[_(m(o(ia).redStudyTask.length)+"个打卡 ",1)])),_:1})])),_:1}),c(t,{class:"task-text"},{default:d((()=>[c(g,{class:"task"},{default:d((()=>[_(" 已完成"+m(o(ia).redFulfilNum)+"/"+m(o(ia).redStudyTask.length)+"个任务 ",1)])),_:1}),c(g,{class:"t-bg bg-light-brown task-t-bg"})])),_:1})])),_:1})])),_:1}),c(t,{class:"task-place-list"},{default:d((()=>[(r(!0),i(n,null,p(o(ia).redStudyTask,((a,s)=>(r(),w(t,{class:"task-place-item"},{default:d((()=>[c(F,{subtitle:`第${o(K)(s+1)}篇章`,title:a.name},null,8,["subtitle","title"]),c(t,{class:"task-place-content"},{default:d((()=>[c(t,{class:"scenic-box"},{default:d((()=>[f("img",{class:"scenic",src:a.picture_url},null,8,["src"])])),_:2},1024),c(t,{class:"task-place-desc"},{default:d((()=>[c(t,{class:"task-place-title"},{default:d((()=>[_("篇章内容")])),_:1}),c(t,{class:"t-w-normal",innerHTML:a.description},null,8,["innerHTML"])])),_:2},1024),"check_in"===a.task_type?(r(),w(k,{key:0,onClick:a=>{S({type:"wgs84",success:async function(a){console.log("当前位置的经度："+a.longitude),console.log("当前位置的纬度："+a.latitude);const s=ea(a.latitude,a.longitude);console.log("转换后的坐标：",s)},fail:function(a){T({title:"设备不支持该功能",icon:"none"})}})},class:D([a.disable?"sightsee-disable":"","red-btn f-white"])},{default:d((()=>[_(m(a.is_finished?"已打卡":"立即打卡"),1)])),_:2},1032,["onClick","class"])):v("",!0),"question"===a.task_type?(r(),w(k,{key:1,onClick:s=>(async a=>{if(!Ta())return;if(a.is_finished)return;const s=ia.activity.name;h({url:`/pages/answer/index?id=${a.id}&title=${s}`})})(a),class:"red-btn f-white"},{default:d((()=>[_(m(a.is_finished?"已答题":"开始答题"),1)])),_:2},1032,["onClick"])):v("",!0),"check_in"===a.task_type&&a.disable?(r(),w(t,{key:2,onClick:ja,class:"task-tip pointer"},{default:d((()=>[_(" 当前不在打卡范围内，查看打卡范围 "),c(b,{type:"right",color:"#ccc",size:"12"})])),_:1})):v("",!0),"question"===a.task_type?(r(),w(t,{key:3,class:"task-tip pointer"},{default:d((()=>[_(" 完成答题即可完成打卡 ")])),_:1})):v("",!0)])),_:2},1024)])),_:2},1024)))),256))])),_:1}),c(t,{class:"mar-top-36"},{default:d((()=>[c(F,{subtitle:"PART 01",title:"勋章故事"}),c(t,{class:"item-bg2"},{default:d((()=>[c(t,{class:"medal-box"},{default:d((()=>[c(t,{class:"medal-story"},{default:d((()=>[c(t,{class:"medal-display"},{default:d((()=>[c(t,{class:"medal-title f-white"},{default:d((()=>[_("革命足迹勋章")])),_:1}),c(t,{class:"medals"},{default:d((()=>[(r(!0),i(n,null,p(o(na),(a=>(r(),i("img",{src:a.src,key:a.name},null,8,["src"])))),128))])),_:1})])),_:1}),c(t,{class:"bg-introduce-box"},{default:d((()=>[c(t,{class:"title1 f-white"},{default:d((()=>[_("背景介绍")])),_:1}),c(t,{class:"bg-introduce f-white"},{default:d((()=>[c(t,{class:"indent-1"},{default:d((()=>[_(" 勋章正面雕刻着一个动物肖像，背景则是韶山的山水田园，象征着他的出生地和革命思想的初步孕育。勋章的左侧刻有岳麓书院的古建筑轮廓。 ")])),_:1}),f("br"),c(t,{class:"indent-1"},{default:d((()=>[_(' 勋章的边缘镌刻着"革命的足迹，历史的见证”以及参与此次研学旅行的日期。此外，勋章的材质选择了青铜色合金，增加了历史感和庄重感。 ')])),_:1})])),_:1})])),_:1}),c(t,{class:"medal-introduce-box"},{default:d((()=>[c(t,{class:"title1 f-white",style:{"margin-bottom":"12px"}},{default:d((()=>[_(" 勋章介绍 ")])),_:1}),c(t,{class:"medal-introduce"},{default:d((()=>[c(t,{class:"title2"},{default:d((()=>[_("橘子洲勋章")])),_:1}),c(t,{class:"medal-desc-box transform-r-15"},{default:d((()=>[f("img",{src:q}),c(t,{class:"medal-param1"},{default:d((()=>[c(t,{class:"medal-param1-text"},{default:d((()=>[_(" 圆形 5 X 5(cm) "),f("br"),_(" 50g "),f("br"),_(" 铝合金 "),f("br"),_(" 长沙市煋翘数字科技有限公司 ")])),_:1})])),_:1})])),_:1}),c(t,{class:"medal-desc indent-1 f-white"},{default:d((()=>[_(" “革命足迹勋章”是专为参加“追寻革命先辈步伐”研学旅行的学生设计的。勋章的设计灵感来源于毛泽东青年时期的革命历程，象征着从韶山到岳麓书院再到橘子洲头的精神历程。 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),c(t,{class:"goods-box mar-top-36"},{default:d((()=>[c(F,{subtitle:"PART 02",title:"研学周边"}),c(t,{class:"item-bg"},{default:d((()=>[c(t,{class:"goods-list"},{default:d((()=>[(r(!0),i(n,null,p(o(da),(a=>(r(),w(t,{onClick:Sa,class:"goods-item",key:a.name},{default:d((()=>[f("img",{src:a.src},null,8,["src"]),c(t,{class:"goods-desc"},{default:d((()=>[c(t,{class:"goods-name"},{default:d((()=>[_(m(a.name),1)])),_:2},1024),c(t,{class:"goods-price"},{default:d((()=>[c(g,{class:"signal"},{default:d((()=>[_("￥")])),_:1}),_(" "+m(a.price)+" ",1),c(t,{class:"shopping"},{default:d((()=>[_(" 立即购买 "),c(g,{class:"arrow"},{default:d((()=>[f("img",{src:B})])),_:1})])),_:1})])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1}),c(t,{class:"download-box mar-top-36"},{default:d((()=>[c(F,{subtitle:"PART 03",title:"人生成就有限公司"}),c(t,{class:"download-desc"},{default:d((()=>[c(t,{class:"app-name-box"},{default:d((()=>[f("img",{src:O,alt:""}),c(g,{class:"app-name"},{default:d((()=>[_("LUX  |  人生成就有限公司")])),_:1})])),_:1}),c(t,{class:"app-feature-list"},{default:d((()=>[(r(),i(n,null,p(wa,((a,s)=>c(t,{class:"app-feature",key:s},{default:d((()=>[f("img",{src:a.src},null,8,["src"]),c(t,null,{default:d((()=>[_(m(a.desc),1)])),_:2},1024)])),_:2},1024))),64))])),_:1}),c(t,{class:"download-btn-box"},{default:d((()=>[c(k,{onClick:Ca,class:"red-btn f-white"},{default:d((()=>[_(" 下载APP，体验完整版 ")])),_:1})])),_:1})])),_:1})])),_:1}),c(t,{class:"foot-tip"},{default:d((()=>[_(" *本次活动解释权归长沙市煋翘数字科技有限公司所有 ")])),_:1})])),_:1})])),_:1}),c(Y,{ref_key:"loginDia",ref:ga},null,512),c(I,{ref_key:"openBrowserDia",ref:ma},null,512),c(aa,{themeColor:"#ae292f",ref_key:"showMedalDia",ref:ka},null,512),c(H,{ref_key:"shoppingDia",ref:ba},null,512),c(sa,{ref_key:"locationDia",ref:ha},null,512),c(U,{ref_key:"shareDia",ref:ya},null,512),c(Z,{ref_key:"ruleDia",ref:xa},null,512)],64)}}},[["__scopeId","data-v-34c35a97"]]);export{ia as default};
