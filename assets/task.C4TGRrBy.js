import{J as t,r as e,O as a,A as s}from"./index-DeXclsUq.js";import{h as i,u as r}from"./useDayjs.C3ha3cy2.js";function u(t){return i.request({method:"GET",url:"/api/v1/task/list",custom:{isAuth:!1},params:t})}function l(t){return i.request({method:"GET",url:`/api/v1/task/${t}`,custom:{isAuth:!1}})}const n=t("task",(()=>{const{calculateTimeDifference:t,getCurTime:u,isDate1AfterDate2:l}=r(),n=e({}),d=e(0),c=e("notStart"),m=e({}),v=e([]),o=a((()=>v.value.filter((t=>t.is_finished)).length)),g=e([{imgList:[{src:"../static/img/red-study/travel1.png",title:"走进韶山大合照"},{src:"../static/img/red-study/travel2.png",title:"齐诵《少年中国说》"},{src:"../static/img/red-study/travel3.png",title:"为伟人敬献鲜花"}],desc:"时值初夏季，生命灿烂，万物可期。回望漫漫红程，“红军不怕远征难，万水千山只等闲”的场景依然历历在目,5月20日，长沙市一中双语实验学校的同学们走近韶山，踏足伟人故里，接续奋斗初心，康续红色血脉，再迈红色征途。",title:"“革命先辈的伟大愿景滋养”"},{imgList:[{src:"../static/img/red-study/travel4.png",title:"走进毛泽东同志纪念馆"},{src:"../static/img/red-study/travel5.png",title:"延伸教学及拓展作业"}],desc:"展厅内，同学们参观了“毛泽东纪念室”和“藏品陈列室”。展览室内的珍贵照片和文物，讲述了毛主席从青年时代艰苦奋斗，带领中国人民走过了一条艰难而坎坷的革命道路，到最终取得胜利、建立新中国的光辉历程。,5月20日，长沙市一中双语实验学校的同学们走近韶山，踏足伟人故里，接续奋斗初心，康续红色血脉，再迈红色征途。",title:"“韶山特别支部党史陈列馆”"},{imgList:[{src:"../static/img/red-study/travel6.png",title:"走进毛泽东故居"},{src:"../static/img/red-study/travel7.png",title:"回望毛主席伟大的一生"}],desc:"展厅内，同学们参观了“毛泽东纪念室”和“藏品陈列室”。展览室内的珍贵照片和文物，讲述了毛主席从青年时代艰苦奋斗，带领中国人民走过了一条艰难而坎坷的革命道路，到最终取得胜利、建立新中国的光辉历程。,5月20日，长沙市一中双语实验学校的同学们走近韶山，踏足伟人故里，接续奋斗初心，康续红色血脉，再迈红色征途。",title:"“瞻仰伟人故里”"}]),p=e([]),f=a((()=>p.value.filter((t=>t.is_finished)).length)),k=async t=>{var e;const a=await(s={task_id:t},i.request({method:"GET",url:"/api/v1/task/numberParticipants",custom:{isAuth:!1},params:s}));var s;d.value=(null==(e=a.detail)?void 0:e.number)||0},h=t=>({redStudyTask:p,scenicList:v}[t]);return{scenicList:v,activity:n,timeData:m,activeStatus:c,userNum:d,fulfilNum:o,redStudyTask:p,redFulfilNum:f,redTravelList:g,doneTask:async(t,e)=>{let a=Object.assign({task_id:t},e);try{await function(t){return i.request({method:"POST",url:"/api/v1/task/finish",custom:{isAuth:!0},data:t})}(a),s({title:"任务完成",icon:"success"})}catch(r){s({title:"任务失败",icon:"error"})}},getTaskStatus:(t,e)=>h(t).value.find((t=>t.name===e)).taskStatus,doneFakeTask:async(t,e)=>{let a=h(t);a.value=a.value.map((t=>(t.name===e&&(t.taskStatus=!0),t)))},updateTaskList:(t,e)=>{if(!e||0===e.length)return;let a=h(t);a.value=e,console.log("updateTaskList",a)},changeTaskDisable:(t,e,a)=>{let s=h(t);s.value=s.value.map((t=>(t.id===e&&(t.disable=a),t)))},updateActivity:e=>{n.value=e,(async e=>{if(!(null==e?void 0:e.id))return;const a=u();l(a,e.start_time)&&!l(a,e.end_time)?(m.value=t(a,e.end_time),await k(e.id),c.value="loading"):l(a,e.end_time)?(m.value=t(a,e.end_time),await k(e.id),c.value="end"):c.value="notStart"})(e)}}}));export{l as a,u as g,n as u};
